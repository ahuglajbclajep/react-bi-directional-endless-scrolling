import{r as R,d as xe,j as I,l as ye,C as ee,i as Re,c as Ee,u as Se,T as be,S as Le,b as ke}from"./ScriptSize-fXmRFvuu.js";const K=null,{min:D,max:O,abs:oe,floor:Te}=Math,ie=(e,t,r)=>D(r,O(t,e)),ae=e=>[...e].sort((t,r)=>t-r),ue=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)},re=e=>{let t,r;return()=>(t||(t=!0,r=e()),r)},Y=-1,q=(e,t,r)=>{const n=r?"unshift":"push";for(let o=0;o<t;o++)e[n](Y);return e},$=(e,t)=>{const r=e.t[t];return r===Y?e.o:r},je=(e,t,r)=>{const n=e.t[t]===Y;return e.t[t]=r,e.i=D(t,e.i),n},U=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let r=e.i,n=e.u[r];for(;r<t;)n+=$(e,r),e.u[++r]=n;return e.i=t,n},W=(e,t,r=0,n=e.l-1)=>{for(;r<=n;){const o=Te((r+n)/2),i=U(e,o);if(i<=t){if(i+$(e,o)>t)return o;r=o+1}else n=o-1}return ie(r,0,e.l-1)},le=(e,t,r)=>{const n=t-e.l;return e.i=r?-1:D(t-1,e.i),e.l=t,n>0?(q(e.u,n),q(e.t,n,r),e.o*n):(e.u.splice(n),(r?e.t.splice(0,-n):e.t.splice(n)).reduce((o,i)=>o-(i===Y?e.o:i),0))},fe=typeof window<"u",de=()=>document.documentElement,Ie=e=>e.ownerDocument,Me=e=>e.defaultView,he=re(()=>!!fe&&getComputedStyle(de()).direction==="rtl"),pe=re(()=>/iP(hone|od|ad)/.test(navigator.userAgent)),Ce=re(()=>"scrollBehavior"in de().style),Ae=e=>O(e.h(),e.p()),Oe=e=>!!e.p(),ze=(e,t=40,r=4,n=0,o,i=!1)=>{let u=!!n,x=[],s=0,c=0,h=0,y=0,w=0,E=0,d=0,p=0,T=0,g=u?[0,O(n-1,0)]:K,j=[0,0],N=0;const k=((l,m,b)=>({o:b?b[1]:m,t:b&&b[0]?q(b[0].slice(0,D(l,b[0].length)),O(0,l-b[0].length)):q([],l),l,i:-1,u:q([],l)}))(e,t,o),_=new Set,v=()=>h-c,P=()=>v()+E+w,z=l=>((m,b,A,L)=>{if(L=D(L,m.l-1),U(m,L)<=b){const a=W(m,b+A,L);return[W(m,b,L,a),a]}{const a=W(m,b,void 0,L);return[a,W(m,b+A,a)]}})(k,l,s,j[0]),F=()=>(l=>l.l?U(l,l.l-1)+$(l,l.l-1):0)(k),V=l=>U(k,l)-E,H=l=>$(k,l),X=l=>{l&&(pe()&&p!==0?E+=l:(w+=l,y++))};return{v:()=>x,_:()=>(l=>[l.t.slice(),l.o])(k),m:()=>{if(d)return j;let[l,m]=z(O(0,P()));return g&&(l=D(l,g[0]),m=O(m,g[1])),p!==1&&(l-=O(0,r)),p!==2&&(m+=O(0,r)),j=[O(l,0),D(m,k.l-1)]},$:()=>W(k,P()),S:()=>W(k,P()+s),I:l=>k.t[l]===Y,k:()=>!!g&&k.t.slice(O(0,g[0]-1),D(k.l-1,g[1]+1)+1).includes(Y),T:V,R:H,M:()=>k.l,C:()=>h,H:()=>p!==0,p:()=>s,W:()=>c,h:F,J:()=>y,B:()=>(d=w,w=0,[d,T===2||v()+s>=F()]),O:(l,m)=>{const b=[l,m];return _.add(b),()=>{_.delete(b)}},L:(l,m)=>{let b,A,L=0;switch(l){case 1:{const a=d;d=0;const f=m-h,S=oe(f);a&&S<oe(a)+1||T!==0||(p=f<0?2:1),u&&(g=K,u=!1),h=m,L=4;const M=v();M>=-s&&M<=F()&&(L+=1,A=S>s);break}case 2:L=8,p!==0&&(b=!0,L+=1),p=0,T=0,g=K;break;case 3:{const a=m.filter(([f,S])=>k.t[f]!==S);if(!a.length)break;X(a.reduce((f,[S,M])=>((T===2||(g?!u&&S<g[0]:V(S)+(p===0&&T===0?H(S):0)<v()))&&(f+=M-H(S)),f),0));for(const[f,S]of a){const M=H(f),B=je(k,f,S);i&&(N+=B?S:S-M)}i&&s&&N>s&&(X(((f,S)=>{let M=0;const B=[];f.t.forEach((ne,ge)=>{ne!==Y&&(B.push(ne),ge<S&&M++)}),f.i=-1;const J=ae(B),se=J.length,Q=se/2|0,me=se%2==0?(J[Q-1]+J[Q])/2:J[Q],we=f.o;return((f.o=me)-we)*O(S-M,0)})(k,W(k,P()))),i=!1),L=3,A=!0;break}case 4:s!==m&&(s=m,L=3);break;case 5:m[1]?(X(le(k,m[0],!0)),T=2,L=1):(le(k,m[0]),L=1);break;case 6:c=m;break;case 7:T=1;break;case 8:g=z(m),L=1}L&&(x=[],b&&E&&(w+=E,E=0,y++),_.forEach(([a,f])=>{L&a&&f(A)}))}}},te=setTimeout,Z=(e,t)=>t&&he()?-e:e,Be=(e,t,r,n,o,i)=>{const u=Date.now;let x=0,s=!1,c=!1,h=!1,y=!1;const w=(()=>{let g;const j=()=>{g!=K&&clearTimeout(g)},N=()=>{j(),g=te(()=>{g=K,(()=>{if(s||c)return s=!1,void w();h=!1,e.L(2)})()},150)};return N.P=j,N})(),E=()=>{x=u(),h&&(y=!0),e.L(1,n()),w()},d=g=>{if(s||!e.H()||g.ctrlKey)return;const j=u()-x;150>j&&50<j&&(r?g.deltaX:g.deltaY)&&(s=!0)},p=()=>{c=!0,h=y=!1},T=()=>{c=!1,pe()&&(h=!0)};return t.addEventListener("scroll",E),t.addEventListener("wheel",d,{passive:!0}),t.addEventListener("touchstart",p,{passive:!0}),t.addEventListener("touchend",T,{passive:!0}),{A:()=>{t.removeEventListener("scroll",E),t.removeEventListener("wheel",d),t.removeEventListener("touchstart",p),t.removeEventListener("touchend",T),w.P()},V:()=>{const[g,j]=e.B();g&&(o(Z(g,r),j,y),y=!1,j&&e.p()>e.h()&&e.L(1,n()))}}},Ne=(e,t)=>{let r,n,o;const i=t?"scrollLeft":"scrollTop",u=t?"overflowX":"overflowY",x=async(s,c)=>{if(!r)return void ue(()=>x(s,c));o&&o();const h=()=>{let y;return[new Promise((w,E)=>{y=w,o=E,Oe(e)&&te(E,150)}),e.O(2,()=>{y&&y()})]};if(c&&Ce()){for(;e.L(8,s()),e.k();){const[y,w]=h();try{await y}catch{return}finally{w()}}r.scrollTo({[t?"left":"top"]:Z(s(),t),behavior:"smooth"})}else for(;;){const[y,w]=h();try{r[i]=Z(s(),t),e.L(7),await y}catch{return}finally{w()}}};return{X(s){r=s,n=Be(e,s,t,()=>Z(s[i],t),(c,h,y)=>{if(y){const w=s.style,E=w[u];w[u]="hidden",te(()=>{w[u]=E})}h?(s[i]=e.C()+c,o&&o()):s[i]+=c})},Y(){n&&n.A()},j(s){x(()=>s)},q(s){s+=e.C(),x(()=>s)},D(s,{align:c,smooth:h,offset:y=0}={}){if(s=ie(s,0,e.M()-1),c==="nearest"){const w=e.T(s),E=e.C();if(w<E)c="start";else{if(!(w+e.R(s)>E+e.p()))return;c="end"}}x(()=>y+e.W()+e.T(s)+(c==="end"?e.R(s)-e.p():c==="center"?(e.R(s)-e.p())/2:0),h)},U:()=>{n&&n.V()}}},Pe=e=>{let t;return{F(r){(t||(t=new(Me(Ie(r))).ResizeObserver(e))).observe(r)},G(r){t.unobserve(r)},A(){t&&t.disconnect()}}},De=(e,t)=>{let r;const n=t?"width":"height",o=new WeakMap,i=Pe(u=>{const x=[];for(const{target:s,contentRect:c}of u)if(s.offsetParent)if(s===r)e.L(4,c[n]);else{const h=o.get(s);h!=K&&x.push([h,c[n]])}x.length&&e.L(3,x)});return{K(u){i.F(r=u)},N:(u,x)=>(o.set(u,x),i.F(u),()=>{o.delete(u),i.G(u)}),Y:i.A}},G=fe?R.useLayoutEffect:R.useEffect,C="current",ve=(e,t)=>{if(Array.isArray(e))for(const r of e)ve(r,t);else e==null||typeof e=="boolean"||t.push(e)},Fe=(e,t)=>{const r=e.key;return r??"_"+t},He=e=>{const t=R.useRef();return t[C]||(t[C]=e())},ce=e=>{const t=R.useRef(e);return G(()=>{t[C]=e},[e]),t},We=R.memo(({Z:e,ee:t,te:r,ne:n,oe:o,re:i,ie:u,se:x})=>{const s=R.useRef(null);G(()=>t(s[C],r),[r]);const c=R.useMemo(()=>{const h={position:o&&x?void 0:"absolute",[u?"height":"width"]:"100%",[u?"top":"left"]:0,[u?he()?"right":"left":"top"]:n,visibility:!o||x?"visible":"hidden"};return u&&(h.display="flex"),h},[n,o,x,u]);return I.jsx(i,typeof i=="string"?{ref:s,style:c,children:e}:{ref:s,style:c,index:r,children:e})}),Ye=e=>R.useReducer(e.v,void 0,e.v)[1],_e=(e,t)=>R.useMemo(()=>{if(typeof e=="function")return[e,t||0];const r=(n=>{const o=[];return ve(n,o),o})(e);return[n=>r[n],r.length]},[e,t]),Xe=R.forwardRef(({children:e,count:t,overscan:r,itemSize:n,shift:o,horizontal:i,keepMounted:u,cache:x,startMargin:s=0,ssrCount:c,as:h="div",item:y="div",scrollRef:w,onScroll:E,onScrollEnd:d},p)=>{const[T,g]=_e(e,t),j=R.useRef(null),N=R.useRef(!!c),k=ce(E),_=ce(d),[v,P,z,F]=He(()=>{const a=!!i,f=ze(g,n,r,c,x,!n);return[f,De(f,a),Ne(f,a),a]});g!==v.M()&&v.L(5,[g,o]),s!==v.W()&&v.L(6,s);const V=Ye(v),[H,X]=v.m(),l=v.H(),m=v.J(),b=v.h(),A=[],L=a=>{const f=T(a);return I.jsx(We,{ee:P.N,te:a,ne:v.T(a),oe:v.I(a),re:y,Z:f,ie:F,se:N[C]},Fe(f,a))};G(()=>{N[C]=!1;const a=v.O(1,B=>{B?xe.flushSync(V):V()}),f=v.O(4,()=>{k[C]&&k[C](v.C())}),S=v.O(8,()=>{_[C]&&_[C]()}),M=B=>{P.K(B),z.X(B)};return w?ue(()=>M(w[C])):M(j[C].parentElement),()=>{a(),f(),S(),P.Y(),z.Y()}},[]),G(()=>{z.U()},[m]),R.useImperativeHandle(p,()=>({get cache(){return v._()},get scrollOffset(){return v.C()},get scrollSize(){return Ae(v)},get viewportSize(){return v.p()},findStartIndex:v.$,findEndIndex:v.S,getItemOffset:v.T,getItemSize:v.R,scrollToIndex:z.D,scrollTo:z.j,scrollBy:z.q}),[]);for(let a=H,f=X;a<=f;a++)A.push(L(a));if(u){const a=[],f=[];ae(u).forEach(S=>{S<H&&a.push(L(S)),S>X&&f.push(L(S))}),A.unshift(...a),A.push(...f)}return I.jsx(h,{ref:j,style:{overflowAnchor:"none",flex:"none",position:"relative",visibility:"hidden",width:F?b:"100%",height:F?"100%":b,pointerEvents:l?"none":void 0},children:A})}),Ke=({initialIndex:e,handlerRef:t})=>{const r=R.useRef(null),[n,o]=R.useState([]),i=R.useRef(e),[u,x]=R.useState(!1),s=R.useRef(!1),c=R.useCallback(async(...d)=>{s.current=!0;const p=await ye(...d);return s.current=!1,p},[]),[h,y]=R.useState("load");R.useEffect(()=>{h==="load"&&(async()=>{const d=i.current-ee/2,p=await c(d);x(!1),o(p),i.current=d,y("postload")})()},[c,h]),R.useEffect(()=>{var d;h==="postload"&&((d=r.current)==null||d.scrollToIndex(ee/2,{align:"start"}),y("postload"))},[h]);const w=R.useCallback(async()=>{if(!(!r.current||s.current)){if(r.current.findEndIndex()+1===n.length){const d=i.current+n.length,p=await c(d);x(!1),o(T=>[...T,...p])}else if(r.current.findStartIndex()<=0){const d=i.current-ee,p=await c(d);x(!0),o(T=>[...p,...T]),i.current-=p.length}}},[c,n.length]),E=R.useCallback(async d=>{if(!r.current)return;const p=i.current;d>=p&&d<p+n.length?r.current.scrollToIndex(d-p,{align:"start"}):(i.current=d,y("load"))},[n.length]);return R.useImperativeHandle(t,()=>({scrollTo:E}),[E]),I.jsx("div",{className:"h-[300px] overflow-y-auto",children:I.jsx(Xe,{ref:r,onScroll:w,shift:u,children:n.map(d=>{const p=Number(d.split("#")[1]);return I.jsx("div",{style:Re(p),children:d},p)})})})},Ve=()=>{const{handler:e,scrollTo:t}=Se();return I.jsxs("div",{className:"p-4 flex flex-col gap-1",children:[I.jsxs("div",{className:"flex items-center justify-between",children:[I.jsxs("div",{className:"flex items-end gap-2",children:[I.jsx(be,{name:"virtua",link:"https://github.com/inokawa/virtua"}),I.jsx(Le,{scriptName:"virtua"})]}),I.jsx(ke,{scrollTo:t})]}),I.jsx(Ke,{initialIndex:500,handlerRef:e})]})};Ee.createRoot(document.getElementById("virtua")).render(I.jsx(Ve,{}));
