import{r as g,d as xe,j,l as ye,C as ne,i as Re,c as Ee,u as Se,T as be,S as Le,b as ke}from"./ScriptSize-fXmRFvuu.js";const J=null,{min:P,max:O,abs:oe,floor:Te}=Math,ie=(e,t,r)=>P(r,O(t,e)),ue=e=>[...e].sort((t,r)=>t-r),ae=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)},te=e=>{let t,r;return()=>(t||(t=!0,r=e()),r)},Y=-1,V=(e,t,r)=>{const n=r?"unshift":"push";for(let l=0;l<t;l++)e[n](Y);return e},$=(e,t)=>{const r=e.t[t];return r===Y?e.o:r},je=(e,t,r)=>{const n=e.t[t]===Y;return e.t[t]=r,e.i=P(t,e.i),n},U=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let r=e.i,n=e.u[r];for(;r<t;)n+=$(e,r),e.u[++r]=n;return e.i=t,n},W=(e,t,r=0,n=e.l-1)=>{for(;r<=n;){const l=Te((r+n)/2),i=U(e,l);if(i<=t){if(i+$(e,l)>t)return l;r=l+1}else n=l-1}return ie(r,0,e.l-1)},le=(e,t,r)=>{const n=t-e.l;return e.i=r?-1:P(t-1,e.i),e.l=t,n>0?(V(e.u,n),V(e.t,n,r),e.o*n):(e.u.splice(n),(r?e.t.splice(0,-n):e.t.splice(n)).reduce((l,i)=>l-(i===Y?e.o:i),0))},fe=typeof window<"u",de=()=>document.documentElement,Ie=e=>e.ownerDocument,Me=e=>e.defaultView,he=te(()=>!!fe&&getComputedStyle(de()).direction==="rtl"),pe=te(()=>/iP(hone|od|ad)/.test(navigator.userAgent)),Ce=te(()=>"scrollBehavior"in de().style),Ae=e=>O(e.h(),e.p()),Oe=e=>!!e.p(),ze=(e,t=40,r=4,n=0,l,i=!1)=>{let d=!!n,x=[],s=0,u=0,m=0,R=0,p=0,y=0,I=0,T=0,a=0,o=d?[0,O(n-1,0)]:J,k=[0,0],N=0;const L=((c,w,S)=>({o:S?S[1]:w,t:S&&S[0]?V(S[0].slice(0,P(c,S[0].length)),O(0,c-S[0].length)):V([],c),l:c,i:-1,u:V([],c)}))(e,t,l),_=new Set,v=()=>m-u,F=()=>v()+y+p,z=c=>((w,S,A,b)=>{if(b=P(b,w.l-1),U(w,b)<=S){const f=W(w,S+A,b);return[W(w,S,b,f),f]}{const f=W(w,S,void 0,b);return[f,W(w,S+A,f)]}})(L,c,s,k[0]),D=()=>(c=>c.l?U(c,c.l-1)+$(c,c.l-1):0)(L),K=c=>U(L,c)-y,H=c=>$(L,c),X=c=>{c&&(pe()&&T!==0?y+=c:(p+=c,R++))};return{v:()=>x,_:()=>(c=>[c.t.slice(),c.o])(L),m:()=>{if(I)return k;let[c,w]=z(O(0,F()));return o&&(c=P(c,o[0]),w=O(w,o[1])),T!==1&&(c-=O(0,r)),T!==2&&(w+=O(0,r)),k=[O(c,0),P(w,L.l-1)]},$:()=>W(L,F()),S:()=>W(L,F()+s),I:c=>L.t[c]===Y,k:()=>!!o&&L.t.slice(O(0,o[0]-1),P(L.l-1,o[1]+1)+1).includes(Y),T:K,R:H,M:()=>L.l,C:()=>m,H:()=>T!==0,p:()=>s,W:()=>u,h:D,J:()=>R,B:()=>(I=p,p=0,[I,a===2||v()+s>=D()]),O:(c,w)=>{const S=[c,w];return _.add(S),()=>{_.delete(S)}},L:(c,w)=>{let S,A,b=0;switch(c){case 1:{const f=I;I=0;const h=w-m,E=oe(h);f&&E<oe(f)+1||a!==0||(T=h<0?2:1),d&&(o=J,d=!1),m=w,b=4;const M=v();M>=-s&&M<=D()&&(b+=1,A=E>s);break}case 2:b=8,T!==0&&(S=!0,b+=1),T=0,a=0,o=J;break;case 3:{const f=w.filter(([h,E])=>L.t[h]!==E);if(!f.length)break;X(f.reduce((h,[E,M])=>((a===2||(o?!d&&E<o[0]:K(E)+(T===0&&a===0?H(E):0)<v()))&&(h+=M-H(E)),h),0));for(const[h,E]of f){const M=H(h),B=je(L,h,E);i&&(N+=B?E:E-M)}i&&s&&N>s&&(X(((h,E)=>{let M=0;const B=[];h.t.forEach((se,ge)=>{se!==Y&&(B.push(se),ge<E&&M++)}),h.i=-1;const q=ue(B),re=q.length,Q=re/2|0,ve=re%2==0?(q[Q-1]+q[Q])/2:q[Q],we=h.o;return((h.o=ve)-we)*O(E-M,0)})(L,W(L,F()))),i=!1),b=3,A=!0;break}case 4:s!==w&&(s=w,b=3);break;case 5:w[1]?(X(le(L,w[0],!0)),a=2,b=1):(le(L,w[0]),b=1);break;case 6:u=w;break;case 7:a=1;break;case 8:o=z(w),b=1}b&&(x=[],S&&y&&(p+=y,y=0,R++),_.forEach(([f,h])=>{b&f&&h(A)}))}}},ee=setTimeout,Z=(e,t)=>t&&he()?-e:e,Be=(e,t,r,n,l,i)=>{const d=Date.now;let x=0,s=!1,u=!1,m=!1,R=!1;const p=(()=>{let o;const k=()=>{o!=J&&clearTimeout(o)},N=()=>{k(),o=ee(()=>{o=J,(()=>{if(s||u)return s=!1,void p();m=!1,e.L(2)})()},150)};return N.P=k,N})(),y=()=>{x=d(),m&&(R=!0),e.L(1,n()),p()},I=o=>{if(s||!e.H()||o.ctrlKey)return;const k=d()-x;150>k&&50<k&&(r?o.deltaX:o.deltaY)&&(s=!0)},T=()=>{u=!0,m=R=!1},a=()=>{u=!1,pe()&&(m=!0)};return t.addEventListener("scroll",y),t.addEventListener("wheel",I,{passive:!0}),t.addEventListener("touchstart",T,{passive:!0}),t.addEventListener("touchend",a,{passive:!0}),{A:()=>{t.removeEventListener("scroll",y),t.removeEventListener("wheel",I),t.removeEventListener("touchstart",T),t.removeEventListener("touchend",a),p.P()},V:()=>{const[o,k]=e.B();o&&(l(Z(o,r),k,R),R=!1,k&&e.p()>e.h()&&e.L(1,n()))}}},Ne=(e,t)=>{let r,n,l;const i=t?"scrollLeft":"scrollTop",d=t?"overflowX":"overflowY",x=async(s,u)=>{if(!r)return void ae(()=>x(s,u));l&&l();const m=()=>{let R;return[new Promise((p,y)=>{R=p,l=y,Oe(e)&&ee(y,150)}),e.O(2,()=>{R&&R()})]};if(u&&Ce()){for(;e.L(8,s()),e.k();){const[R,p]=m();try{await R}catch{return}finally{p()}}r.scrollTo({[t?"left":"top"]:Z(s(),t),behavior:"smooth"})}else for(;;){const[R,p]=m();try{r[i]=Z(s(),t),e.L(7),await R}catch{return}finally{p()}}};return{X(s){r=s,n=Be(e,s,t,()=>Z(s[i],t),(u,m,R)=>{if(R){const p=s.style,y=p[d];p[d]="hidden",ee(()=>{p[d]=y})}m?(s[i]=e.C()+u,l&&l()):s[i]+=u})},Y(){n&&n.A()},j(s){x(()=>s)},q(s){s+=e.C(),x(()=>s)},D(s,{align:u,smooth:m,offset:R=0}={}){if(s=ie(s,0,e.M()-1),u==="nearest"){const p=e.T(s),y=e.C();if(p<y)u="start";else{if(!(p+e.R(s)>y+e.p()))return;u="end"}}x(()=>R+e.W()+e.T(s)+(u==="end"?e.R(s)-e.p():u==="center"?(e.R(s)-e.p())/2:0),m)},U:()=>{n&&n.V()}}},Fe=e=>{let t;return{F(r){(t||(t=new(Me(Ie(r))).ResizeObserver(e))).observe(r)},G(r){t.unobserve(r)},A(){t&&t.disconnect()}}},Pe=(e,t)=>{let r;const n=t?"width":"height",l=new WeakMap,i=Fe(d=>{const x=[];for(const{target:s,contentRect:u}of d)if(s.offsetParent)if(s===r)e.L(4,u[n]);else{const m=l.get(s);m!=J&&x.push([m,u[n]])}x.length&&e.L(3,x)});return{K(d){i.F(r=d)},N:(d,x)=>(l.set(d,x),i.F(d),()=>{l.delete(d),i.G(d)}),Y:i.A}},G=fe?g.useLayoutEffect:g.useEffect,C="current",me=(e,t)=>{if(Array.isArray(e))for(const r of e)me(r,t);else e==null||typeof e=="boolean"||t.push(e)},De=(e,t)=>{const r=e.key;return r??"_"+t},He=e=>{const t=g.useRef();return t[C]||(t[C]=e())},ce=e=>{const t=g.useRef(e);return G(()=>{t[C]=e},[e]),t},We=g.memo(({Z:e,ee:t,te:r,ne:n,oe:l,re:i,ie:d,se:x})=>{const s=g.useRef(null);G(()=>t(s[C],r),[r]);const u=g.useMemo(()=>{const m={position:l&&x?void 0:"absolute",[d?"height":"width"]:"100%",[d?"top":"left"]:0,[d?he()?"right":"left":"top"]:n,visibility:!l||x?"visible":"hidden"};return d&&(m.display="flex"),m},[n,l,x,d]);return j.jsx(i,typeof i=="string"?{ref:s,style:u,children:e}:{ref:s,style:u,index:r,children:e})}),Ye=e=>g.useReducer(e.v,void 0,e.v)[1],_e=(e,t)=>g.useMemo(()=>{if(typeof e=="function")return[e,t||0];const r=(n=>{const l=[];return me(n,l),l})(e);return[n=>r[n],r.length]},[e,t]),Xe=g.forwardRef(({children:e,count:t,overscan:r,itemSize:n,shift:l,horizontal:i,keepMounted:d,cache:x,startMargin:s=0,ssrCount:u,as:m="div",item:R="div",scrollRef:p,onScroll:y,onScrollEnd:I},T)=>{const[a,o]=_e(e,t),k=g.useRef(null),N=g.useRef(!!u),L=ce(y),_=ce(I),[v,F,z,D]=He(()=>{const f=!!i,h=ze(o,n,r,u,x,!n);return[h,Pe(h,f),Ne(h,f),f]});o!==v.M()&&v.L(5,[o,l]),s!==v.W()&&v.L(6,s);const K=Ye(v),[H,X]=v.m(),c=v.H(),w=v.J(),S=v.h(),A=[],b=f=>{const h=a(f);return j.jsx(We,{ee:F.N,te:f,ne:v.T(f),oe:v.I(f),re:R,Z:h,ie:D,se:N[C]},De(h,f))};G(()=>{N[C]=!1;const f=v.O(1,B=>{B?xe.flushSync(K):K()}),h=v.O(4,()=>{L[C]&&L[C](v.C())}),E=v.O(8,()=>{_[C]&&_[C]()}),M=B=>{F.K(B),z.X(B)};return p?ae(()=>M(p[C])):M(k[C].parentElement),()=>{f(),h(),E(),F.Y(),z.Y()}},[]),G(()=>{z.U()},[w]),g.useImperativeHandle(T,()=>({get cache(){return v._()},get scrollOffset(){return v.C()},get scrollSize(){return Ae(v)},get viewportSize(){return v.p()},findStartIndex:v.$,findEndIndex:v.S,getItemOffset:v.T,getItemSize:v.R,scrollToIndex:z.D,scrollTo:z.j,scrollBy:z.q}),[]);for(let f=H,h=X;f<=h;f++)A.push(b(f));if(d){const f=[],h=[];ue(d).forEach(E=>{E<H&&f.push(b(E)),E>X&&h.push(b(E))}),A.unshift(...f),A.push(...h)}return j.jsx(m,{ref:k,style:{overflowAnchor:"none",flex:"none",position:"relative",visibility:"hidden",width:D?S:"100%",height:D?"100%":S,pointerEvents:c?"none":void 0},children:A})}),Je=({initialIndex:e,handlerRef:t})=>{const r=g.useRef(null),[n,l]=g.useState([]),i=g.useRef(e),[d,x]=g.useState(!1),s=g.useRef(!1),u=g.useCallback(async(...a)=>{s.current=!0;const o=await ye(...a);return s.current=!1,o},[]),m=g.useRef(!0),R=g.useCallback(async()=>{if(!r.current||s.current||m.current){m.current=!1;return}if(r.current.findEndIndex()+1===n.length){const a=i.current+n.length,o=await u(a);x(!1),l(k=>[...k,...o]),m.current=!0}else if(r.current.findStartIndex()<=0){const a=i.current-ne,o=await u(a);x(!0),l(k=>[...o,...k]),i.current-=o.length,m.current=!0}},[u,n.length]),[p,y]=g.useState("load"),I=g.useCallback(async a=>{if(!r.current)return;const o=i.current;a>=o&&a<o+n.length?r.current.scrollToIndex(a-o,{align:"start"}):(i.current=a,y("load"))},[n.length]),T=g.useRef(0);return g.useEffect(()=>{p==="load"&&(async()=>{const a=i.current-Math.floor(ne/2),o=await u(a);x(!1),l(o),T.current=i.current-a,i.current=a,y("postload")})()},[u,p]),g.useEffect(()=>{var a;p==="postload"&&((a=r.current)==null||a.scrollToIndex(T.current,{align:"start"}),y("preload"))},[p]),g.useImperativeHandle(t,()=>({scrollTo:I}),[I]),j.jsx("div",{className:"h-[300px] overflow-y-auto",children:j.jsx(Xe,{ref:r,onScroll:R,shift:d,children:n.map(a=>{const o=Number(a.split("#")[1]);return j.jsx("div",{style:Re(o),children:a},o)})})})},Ke=()=>{const{handler:e,scrollTo:t}=Se();return j.jsxs("div",{className:"flex flex-col gap-1",children:[j.jsxs("div",{className:"flex gap-1 flex-col sm:flex-row sm:justify-between",children:[j.jsxs("div",{className:"flex items-end gap-2",children:[j.jsx(be,{name:"virtua",link:"https://github.com/inokawa/virtua"}),j.jsx(Le,{scriptName:"virtua"})]}),j.jsx(ke,{scrollTo:t})]}),j.jsx(Je,{initialIndex:500,handlerRef:e})]})};Ee.createRoot(document.getElementById("virtua")).render(j.jsx(Ke,{}));
